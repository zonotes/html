<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ìò∏ÌÖî</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        :root {
            --bg-color: #f8fafc;
            --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent-color: #3b82f6;
            --accent-light: #dbeafe;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-gradient);
            color: var(--text-primary);
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            margin: 0;
            padding: 24px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            overflow-y: auto;
        }

        .container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            min-height: auto;
            gap: 24px;
        }

        .left-panel {
            flex: 3;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .date-info {
            background: linear-gradient(135deg, var(--accent-color) 0%, #2563eb 100%);
            border-radius: 12px;
            padding: 16px 20px;
            color: #ffffff;
            font-size: 0.95rem;
            font-weight: 500;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .date-info::before {
            content: 'üìÖ';
            font-size: 1.1rem;
        }

        .range-controls {
            display: flex;
            flex-wrap: nowrap;
            gap: 6px;
            margin-bottom: 8px;
        }

        .range-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 4px 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .range-btn:hover {
            background: var(--accent-light);
            color: var(--accent-color);
            border-color: var(--accent-color);
            transform: translateY(-1px);
        }

        .range-btn.active {
            background: var(--accent-color);
            color: #ffffff;
            border-color: var(--accent-color);
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
        }

        .chart-wrapper {
            flex: none;
            height: 400px;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            padding: 20px;
            box-shadow: var(--shadow-md);
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            transition: box-shadow 0.3s ease;
        }

        .chart-wrapper:hover {
            box-shadow: var(--shadow-lg);
        }

        .chart-wrapper h2 {
            margin: 0 0 12px 0;
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-wrapper h2::before {
            content: '';
            width: 4px;
            height: 18px;
            background: var(--accent-color);
            border-radius: 2px;
        }

        .canvas-container {
            flex: 1;
            position: relative;
            width: 100%;
            min-height: 0;
        }

        .controls-container {
            flex: 1.2;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            padding: 24px;
            font-size: 0.85rem;
            overflow-y: auto;
            min-width: 260px;
            max-width: 300px;
            box-shadow: var(--shadow-md);
        }

        .controls-header {
            font-size: 1.15rem;
            font-weight: 700;
            margin-bottom: 24px;
            color: var(--text-primary);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .controls-header::before {
            content: '‚öôÔ∏è';
            font-size: 1.1rem;
        }

        .control-group {
            margin-bottom: 24px;
        }

        .control-group-title {
            font-size: 0.75rem;
            color: var(--accent-color);
            font-weight: 700;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .control-group-title::before {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--accent-color);
            border-radius: 50%;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid transparent;
        }

        .checkbox-item:hover {
            background: var(--accent-light);
            border-color: var(--border-color);
        }

        .checkbox-item input {
            appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            margin-right: 10px;
            position: relative;
            cursor: pointer;
            background-color: var(--card-bg);
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .checkbox-item input:checked {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }

        .checkbox-item input:checked::after {
            content: '‚úì';
            position: absolute;
            color: #fff;
            font-size: 12px;
            font-weight: 700;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .checkbox-item span {
            color: var(--text-secondary);
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.2s ease;
        }

        .checkbox-item input:checked+span {
            color: var(--text-primary);
            font-weight: 600;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Data Tables Section */
        .data-tables-section {
            display: flex;
            gap: 16px;
            margin-top: 16px;
        }

        .data-table-wrapper {
            flex: 1;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 16px;
            box-shadow: var(--shadow-sm);
        }

        .data-table-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--accent-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.75rem;
        }

        .data-table th,
        .data-table td {
            padding: 6px 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .data-table th {
            background: #f8fafc;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.7rem;
        }

        .data-table th.group-header {
            background: var(--accent-light);
            color: var(--accent-color);
        }

        .data-table td {
            color: var(--text-primary);
        }

        .data-table td.row-label {
            background: #f8fafc;
            font-weight: 500;
            color: var(--text-secondary);
            text-align: left;
        }

        .data-table td.highlight {
            color: var(--accent-color);
            font-weight: 600;
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="left-panel">
            <!-- Date Info Header -->
            <div class="date-info">
                Ïò§Îäò : 2026ÎÖÑ 8Ïõî 24Ïùº / ÎåÄÏÉÅÏùº : 2026ÎÖÑ 9Ïõî 25Ïùº (D-30)
            </div>

            <div class="charts-container" style="display: flex; flex-direction: column; flex: 1; gap: 15px;">
                <!-- Top Chart: OCC & ADR -->
                <div class="chart-wrapper">
                    <h2>ÏÑ±Í≥º ÏßÄÌëú (OCC / ADR)</h2>
                    <div class="canvas-container">
                        <canvas id="topChart"></canvas>
                    </div>
                </div>
                <!-- Bottom Chart: Competitor Prices -->
                <div class="chart-wrapper">
                    <h2>Í∞ÄÍ≤© ÎπÑÍµê</h2>
                    <div class="canvas-container">
                        <canvas id="bottomChart"></canvas>
                    </div>
                </div>

                <!-- Data Tables Section -->
                <div class="data-tables-section">
                    <!-- Î†àÏ†Ä/Í∑∏Î£π ÌÖåÏù¥Î∏î -->
                    <div class="data-table-wrapper">
                        <div class="data-table-title">Î†àÏ†Ä/Í∑∏Î£π</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th colspan="2" class="group-header">D-30</th>
                                    <th colspan="2" class="group-header">ÎßàÍ∞ê</th>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th>Transient</th>
                                    <th>Group</th>
                                    <th>Transient</th>
                                    <th>Group</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="row-label">ÎåÄÏÉÅÏùº</td>
                                    <td class="highlight">100% (152)</td>
                                    <td>0% (0)</td>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td class="row-label">Ï†ÑÎÖÑÎßàÍ∞ê</td>
                                    <td>100% (191)</td>
                                    <td>0% (0)</td>
                                    <td>100% (316)</td>
                                    <td>0% (0)</td>
                                </tr>
                                <tr>
                                    <td class="row-label">ÏµúÍ≥†Í∞ÄÏãúÍ∏∞</td>
                                    <td>98% (201)</td>
                                    <td>2% (4)</td>
                                    <td>89% (367)</td>
                                    <td>11% (45)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ÎÇ¥Íµ≠Ïù∏/Ïô∏Íµ≠Ïù∏ ÌÖåÏù¥Î∏î -->
                    <div class="data-table-wrapper">
                        <div class="data-table-title">ÎÇ¥Íµ≠Ïù∏/Ïô∏Íµ≠Ïù∏</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th colspan="2" class="group-header">D-30</th>
                                    <th colspan="2" class="group-header">ÎßàÍ∞ê</th>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th>ÎÇ¥Íµ≠Ïù∏</th>
                                    <th>Ïô∏Íµ≠Ïù∏</th>
                                    <th>ÎÇ¥Íµ≠Ïù∏</th>
                                    <th>Ïô∏Íµ≠Ïù∏</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="row-label">ÎåÄÏÉÅÏùº</td>
                                    <td class="highlight">93% (141)</td>
                                    <td>7% (11)</td>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td class="row-label">Ï†ÑÎÖÑÎßàÍ∞ê</td>
                                    <td>94% (180)</td>
                                    <td>6% (0)</td>
                                    <td>92% (290)</td>
                                    <td>8% (26)</td>
                                </tr>
                                <tr>
                                    <td class="row-label">ÏµúÍ≥†Í∞ÄÏãúÍ∏∞</td>
                                    <td>95% (195)</td>
                                    <td>5% (10)</td>
                                    <td class="highlight">94% (387)</td>
                                    <td>6% (26)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="controls-container">
            <div class="controls-header">Îç∞Ïù¥ÌÑ∞ ÏÑ†ÌÉù</div>

            <div class="control-group">
                <div class="control-group-title">Í∏∞Í∞Ñ ÏÑ†ÌÉù</div>
                <div class="range-controls">
                    <button class="range-btn" onclick="setRange('all', this)">365Ïùº</button>
                    <button class="range-btn active" onclick="setRange(120, this)">120Ïùº</button>
                    <button class="range-btn" onclick="setRange(60, this)">60Ïùº</button>
                    <button class="range-btn" onclick="setRange(30, this)">30Ïùº</button>
                </div>
            </div>

            <div class="control-group">
                <div class="control-group-title">ÏÑ±Í≥º ÏßÄÌëú</div>
                <div id="topControls"></div>
            </div>

            <div class="control-group">
                <div class="control-group-title">Ìò∏ÌÖîÎ≥Ñ Í∞ÄÍ≤©</div>
                <div id="bottomControls"></div>
            </div>
        </div>
    </div>

    <script>
        // --- Data Parsing ---
        const rawData = `N	OCC ÏûêÏÇ¨	OCC Ï†ÑÎÖÑ	OCC ÏµúÍ≥†Í∞ÄÏãúÍ∏∞	OCC Í≤ΩÏüÅÏÇ¨	ADR	ADR Ï†ÑÎÖÑ	ADR ÏµúÍ≥†Í∞ÄÏãúÍ∏∞	ÏûêÏÇ¨ÏµúÏ†ÄÍ∞Ä	Í≤ΩÏüÅÏÇ¨ ÏµúÏ†ÄÍ∞Ä	Stanford_Hotel_Myeongdong	Crown_Park_Hotel_Seoul_Myeongdong	L7_MYEONGDONG_by_LOTTE_HOTELS	Shilla_Stay_Gwanghwamun_Myeongdong	Nine_Tree_by_Parnas_Seoul_Myeongdong_2	Four_Points_by_Sheraton_Josun_Seoul_Myeongdong	Ibis_Ambassador_Myeongdong	Aloft_Seoul_Myeongdong
0	90.8% 	72.6% 	94.9% 	91.3% 	 289,244 	 183,228 	 335,243 	 310,000 	 339,894 	 350,000 	 292,091 	 380,000 	 350,000 	 360,000 	 357,382 	 242,880 	 359,100 
1	89.2% 	72.0% 	93.8% 	89.7% 	 288,714 	 183,218 	 334,824 	 310,000 	 345,076 	 360,000 	 292,091 	 400,000 	 350,000 	 360,000 	 357,382 	 237,600 	 350,550 
2	85.7% 	69.7% 	92.4% 	88.0% 	 288,302 	 183,432 	 333,955 	 310,000 	 327,468 	 360,000 	 292,091 	 261,000 	 330,000 	 360,000 	 397,091 	 237,600 	 315,495 
3	83.4% 	69.2% 	90.8% 	86.2% 	 288,359 	 183,408 	 333,082 	 310,000 	 323,996 	 360,000 	 429,545 	 261,000 	 313,500 	 360,000 	 357,382 	 237,600 	 315,495 
4	80.9% 	68.3% 	88.8% 	84.4% 	 288,368 	 183,389 	 332,284 	 330,000 	 375,762 	 350,000 	 429,545 	 261,000 	 313,500 	 340,000 	 397,091 	 460,000 	 340,200 
5	76.6% 	67.1% 	85.4% 	80.9% 	 287,985 	 183,482 	 331,810 	 330,000 	 327,961 	 350,000 	 334,091 	 261,000 	 313,500 	 340,000 	 357,382 	 276,000 	 330,885 
6	73.3% 	66.0% 	83.1% 	77.0% 	 286,574 	 183,631 	 331,149 	 330,000 	 320,923 	 350,000 	 334,091 	 261,000 	 313,500 	 340,000 	 268,036 	 276,000 	 378,000 
7	70.1% 	65.3% 	81.7% 	73.3% 	 287,575 	 183,677 	 330,372 	 330,000 	 328,913 	 330,000 	 334,091 	 261,000 	 332,500 	 340,000 	 297,818 	 306,000 	 330,885 
8	67.4% 	64.6% 	79.9% 	71.0% 	 287,185 	 183,681 	 329,752 	 330,000 	 323,345 	 330,000 	 300,682 	 261,000 	 332,500 	 340,000 	 297,818 	 306,000 	 330,885 
9	64.6% 	64.1% 	78.0% 	68.0% 	 287,351 	 183,826 	 329,091 	 330,000 	 336,053 	 362,000 	 284,302 	 261,000 	 332,500 	 340,000 	 297,818 	 306,000 	 378,000 
10	61.6% 	64.1% 	76.1% 	64.1% 	 286,099 	 183,826 	 328,376 	 320,000 	 329,740 	 330,000 	 284,302 	 261,000 	 332,500 	 340,000 	 273,993 	 306,000 	 340,200 
11	58.9% 	63.2% 	74.1% 	61.1% 	 284,986 	 183,891 	 327,390 	 320,000 	 317,042 	 330,000 	 284,302 	 261,000 	 332,500 	 340,000 	 273,993 	 280,500 	 378,000 
12	57.2% 	62.3% 	72.2% 	60.5% 	 284,883 	 183,899 	 326,325 	 320,000 	 298,097 	 330,000 	 284,302 	 261,000 	 247,000 	 340,000 	 273,993 	 280,500 	 330,885 
13	56.3% 	61.1% 	70.9% 	56.8% 	 286,392 	 184,351 	 325,545 	 320,000 	 307,917 	 330,000 	 284,302 	 261,000 	 247,000 	 340,000 	 297,818 	 306,000 	 340,200 
14	53.3% 	60.0% 	69.4% 	54.5% 	 286,140 	 184,536 	 324,249 	 340,000 	 300,354 	 330,000 	 241,462 	 261,000 	 247,000 	 340,000 	 297,818 	 306,000 	 340,200 
15	51.7% 	59.3% 	67.9% 	54.5% 	 285,196 	 184,722 	 324,003 	 340,000 	 300,354 	 330,000 	 241,462 	 261,000 	 247,000 	 340,000 	 297,818 	 306,000 	 340,200 
16	51.7% 	58.6% 	66.0% 	53.8% 	 285,196 	 184,804 	 323,837 	 340,000 	 314,730 	 330,000 	 268,291 	 261,000 	 247,000 	 340,000 	 397,091 	 306,000 	 340,200 
17	51.0% 	58.6% 	64.4% 	53.3% 	 284,670 	 184,804 	 323,074 	 340,000 	 298,926 	 330,000 	 241,462 	 261,000 	 247,000 	 330,000 	 297,818 	 306,000 	 340,200 
18	50.8% 	57.2% 	62.7% 	52.4% 	 284,275 	 184,832 	 322,480 	 340,000 	 289,904 	 340,000 	 268,291 	 261,000 	 228,000 	 330,000 	 267,135 	 306,000 	 307,800 
19	50.3% 	57.0% 	61.4% 	50.6% 	 283,809 	 184,811 	 321,592 	 340,000 	 291,946 	 340,000 	 241,462 	 261,000 	 228,000 	 330,000 	 290,364 	 306,000 	 307,800 
20	48.0% 	55.4% 	60.2% 	50.3% 	 283,069 	 185,193 	 321,182 	 340,000 	 319,191 	 340,000 	 410,875 	 261,000 	 234,000 	 330,000 	 290,364 	 321,300 	 307,800 
21	47.6% 	53.1% 	59.0% 	49.2% 	 283,759 	 185,931 	 320,344 	 340,000 	 322,894 	 340,000 	 410,875 	 261,000 	 234,000 	 330,000 	 290,364 	 378,000 	 277,020 
22	46.4% 	52.2% 	57.9% 	49.2% 	 285,153 	 186,216 	 319,631 	 340,000 	 313,534 	 340,000 	 248,564 	 261,000 	 234,000 	 330,000 	 387,151 	 378,000 	 277,020 
23	46.4% 	50.6% 	56.1% 	46.7% 	 285,153 	 186,704 	 320,218 	 340,000 	 298,692 	 340,000 	 241,462 	 261,000 	 234,000 	 330,000 	 290,364 	 378,000 	 277,020 
24	43.9% 	49.4% 	54.5% 	46.2% 	 283,378 	 187,019 	 319,771 	 310,000 	 305,572 	 340,000 	 241,462 	 261,000 	 234,000 	 330,000 	 290,364 	 420,000 	 283,176 
25	43.0% 	48.5% 	53.0% 	44.4% 	 282,294 	 187,590 	 319,082 	 310,000 	 287,991 	 340,000 	 276,182 	 261,000 	 216,000 	 330,000 	 290,364 	 275,400 	 243,000 
26	40.9% 	47.6% 	51.8% 	43.4% 	 281,134 	 188,051 	 318,483 	 310,000 	 291,128 	 340,000 	 259,636 	 261,000 	 234,000 	 340,000 	 267,135 	 306,000 	 243,000 
27	40.2% 	46.4% 	50.5% 	40.9% 	 280,427 	 188,226 	 317,772 	 310,000 	 275,274 	 340,000 	 233,673 	 261,000 	 234,000 	 340,000 	 278,182 	 258,060 	 243,000 
28	37.2% 	44.8% 	49.4% 	40.5% 	 278,947 	 188,862 	 317,268 	 300,000 	 272,642 	 340,000 	 238,865 	 261,000 	 216,000 	 340,000 	 278,182 	 252,450 	 243,000 
29	36.3% 	44.8% 	48.3% 	39.3% 	 279,385 	 188,862 	 316,833 	 300,000 	 275,855 	 340,000 	 233,673 	 261,000 	 216,000 	 340,000 	 250,364 	 295,800 	 270,000 
30	34.9% 	43.9% 	47.1% 	38.6% 	 279,405 	 188,765 	 316,487 	 279,000 	 280,375 	 340,000 	 259,636 	 261,000 	 216,000 	 340,000 	 250,364 	 306,000 	 270,000 
30	34.9% 	43.9% 	47.1% 	38.6% 	 279,405 	 188,765 	 316,487 	 279,000 	 280,375 	 340,000 	 259,636 	 261,000 	 216,000 	 340,000 	 250,364 	 306,000 	 270,000 
31	34.3% 	42.8% 	46.0% 	37.2% 	 279,266 	 189,474 	 315,893 	 279,000 	 267,253 	 340,000 	 233,673 	 243,000 	 216,000 	 340,000 	 221,155 	 295,800 	 248,400 
32	33.3% 	42.5% 	44.8% 	36.1% 	 278,887 	 189,471 	 315,210 	 279,000 	 269,078 	 360,000 	 233,673 	 243,000 	 216,000 	 340,000 	 221,155 	 295,800 	 243,000 
33	32.0% 	41.1% 	43.5% 	34.7% 	 278,964 	 190,106 	 314,313 	 279,000 	 272,730 	 360,000 	 233,673 	 243,000 	 216,000 	 340,000 	 250,364 	 295,800 	 243,000 
34	30.8% 	39.8% 	42.4% 	33.8% 	 279,462 	 190,977 	 313,669 	 279,000 	 290,322 	 360,000 	 333,818 	 221,000 	 216,000 	 340,000 	 312,955 	 295,800 	 243,000 
35	29.7% 	39.1% 	41.5% 	33.1% 	 278,733 	 191,175 	 312,940 	 279,000 	 270,105 	 360,000 	 233,673 	 204,000 	 216,000 	 340,000 	 250,364 	 295,800 	 261,000 
36	29.2% 	38.9% 	40.6% 	32.9% 	 279,168 	 191,015 	 312,157 	 300,000 	 270,319 	 360,000 	 233,673 	 204,000 	 216,000 	 340,000 	 278,182 	 295,800 	 234,900 
37	29.0% 	37.9% 	39.6% 	31.7% 	 279,003 	 191,421 	 311,604 	 279,000 	 269,346 	 360,000 	 225,884 	 204,000 	 216,000 	 340,000 	 278,182 	 295,800 	 234,900 
38	28.0% 	37.0% 	38.8% 	30.8% 	 278,698 	 191,912 	 310,911 	 279,000 	 270,233 	 380,000 	 250,982 	 204,000 	 198,000 	 320,000 	 278,182 	 295,800 	 234,900 
39	27.8% 	35.4% 	38.1% 	30.1% 	 278,619 	 192,959 	 310,330 	 279,000 	 273,096 	 380,000 	 225,884 	 234,000 	 216,000 	 320,000 	 278,182 	 295,800 	 234,900 
40	27.1% 	32.6% 	37.2% 	29.2% 	 278,679 	 193,551 	 309,709 	 279,000 	 275,346 	 380,000 	 225,884 	 252,000 	 216,000 	 320,000 	 278,182 	 295,800 	 234,900 
41	26.2% 	32.2% 	36.3% 	28.5% 	 279,042 	 193,212 	 309,232 	 260,400 	 273,846 	 360,000 	 225,884 	 260,000 	 216,000 	 320,000 	 278,182 	 295,800 	 234,900 
42	25.5% 	32.0% 	35.6% 	26.7% 	 279,469 	 193,440 	 309,053 	 260,400 	 274,472 	 360,000 	 250,982 	 252,000 	 216,000 	 320,000 	 266,091 	 295,800 	 234,900 
43	23.9% 	29.9% 	35.1% 	26.2% 	 279,445 	 193,780 	 308,924 	 260,400 	 268,171 	 360,000 	 225,884 	 240,000 	 216,000 	 320,000 	 252,786 	 295,800 	 234,900 
44	23.4% 	28.3% 	34.4% 	25.3% 	 279,622 	 194,355 	 308,554 	 260,400 	 262,364 	 360,000 	 194,727 	 240,000 	 216,000 	 320,000 	 252,786 	 280,500 	 234,900 
45	23.2% 	26.2% 	33.6% 	24.8% 	 279,352 	 196,626 	 308,161 	 260,400 	 256,842 	 360,000 	 194,727 	 216,000 	 216,000 	 320,000 	 227,508 	 285,600 	 234,900 
46	21.8% 	26.0% 	32.6% 	24.4% 	 278,991 	 196,884 	 307,997 	 251,100 	 262,415 	 360,000 	 194,727 	 240,000 	 216,000 	 320,000 	 221,990 	 285,600 	 261,000 
47	21.6% 	24.8% 	31.7% 	23.7% 	 279,457 	 198,073 	 307,447 	 251,100 	 259,152 	 360,000 	 194,727 	 240,000 	 216,000 	 320,000 	 221,990 	 285,600 	 234,900 
48	21.4% 	23.9% 	30.8% 	23.0% 	 279,662 	 199,479 	 306,812 	 251,100 	 259,273 	 340,000 	 194,727 	 240,000 	 216,000 	 320,000 	 216,860 	 285,600 	 261,000 
49	20.2% 	23.7% 	30.1% 	22.8% 	 279,780 	 199,791 	 306,289 	 251,100 	 259,023 	 340,000 	 194,727 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 234,900 
50	20.0% 	22.3% 	29.1% 	22.1% 	 280,109 	 200,561 	 306,656 	 251,100 	 256,011 	 340,000 	 194,727 	 240,000 	 216,000 	 320,000 	 216,860 	 285,600 	 234,900 
51	19.3% 	21.8% 	28.1% 	20.0% 	 282,010 	 199,605 	 307,102 	 251,100 	 273,740 	 340,000 	 286,364 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 261,000 
52	17.7% 	21.4% 	27.4% 	19.3% 	 286,478 	 199,997 	 306,666 	 255,750 	 261,727 	 340,000 	 216,364 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 234,900 
53	17.0% 	21.1% 	26.6% 	18.2% 	 288,059 	 200,251 	 306,174 	 251,100 	 261,523 	 360,000 	 194,727 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 234,900 
54	16.3% 	20.9% 	25.9% 	17.7% 	 289,066 	 200,400 	 305,864 	 251,100 	 256,457 	 300,000 	 214,200 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 234,900 
55	15.9% 	20.2% 	25.2% 	16.8% 	 289,074 	 201,568 	 305,518 	 251,100 	 263,957 	 360,000 	 214,200 	 240,000 	 216,000 	 320,000 	 240,955 	 285,600 	 234,900 
56	15.4% 	19.8% 	24.6% 	16.6% 	 289,776 	 201,574 	 305,498 	 255,750 	 268,318 	 360,000 	 214,200 	 240,000 	 216,000 	 320,000 	 275,845 	 285,600 	 234,900 
57	15.2% 	19.3% 	24.0% 	16.6% 	 290,362 	 201,835 	 305,181 	 275,000 	 271,581 	 360,000 	 214,200 	 240,000 	 216,000 	 320,000 	 275,845 	 285,600 	 261,000 
58	14.7% 	18.4% 	23.5% 	15.6% 	 290,717 	 201,434 	 305,196 	 251,100 	 267,845 	 360,000 	 238,000 	 240,000 	 216,000 	 320,000 	 248,261 	 285,600 	 234,900 
59	14.0% 	18.2% 	22.7% 	15.6% 	 292,022 	 200,561 	 305,485 	 255,750 	 274,812 	 320,000 	 214,200 	 240,000 	 216,000 	 320,000 	 367,795 	 285,600 	 234,900 
60	14.0% 	17.9% 	22.0% 	14.9% 	 292,022 	 199,671 	 305,901 	 269,700 	 255,120 	 300,000 	 214,200 	 240,000 	 198,000 	 320,000 	 248,261 	 285,600 	 234,900 
60	14.0% 	17.9% 	22.0% 	14.9% 	 292,022 	 199,671 	 305,901 	 269,700 	 255,120 	 300,000 	 214,200 	 240,000 	 198,000 	 320,000 	 248,261 	 285,600 	 234,900 
61	13.3% 	17.2% 	21.2% 	14.5% 	 294,706 	 198,745 	 306,053 	 274,350 	 258,095 	 300,000 	 238,000 	 240,000 	 198,000 	 320,000 	 248,261 	 285,600 	 234,900 
62	12.9% 	16.6% 	20.6% 	13.8% 	 297,915 	 197,855 	 306,086 	 251,100 	 257,345 	 300,000 	 214,200 	 240,000 	 198,000 	 320,000 	 290,364 	 285,600 	 210,600 
63	12.0% 	16.6% 	20.0% 	13.8% 	 299,628 	 197,855 	 305,994 	 269,700 	 252,391 	 280,000 	 194,564 	 240,000 	 198,000 	 320,000 	 290,364 	 285,600 	 210,600 
64	12.0% 	16.1% 	19.6% 	13.6% 	 299,628 	 197,623 	 306,077 	 269,700 	 252,931 	 280,000 	 198,887 	 240,000 	 198,000 	 320,000 	 290,364 	 285,600 	 210,600 
65	11.7% 	16.1% 	19.2% 	13.6% 	 300,503 	 197,623 	 306,356 	 269,700 	 256,306 	 280,000 	 225,884 	 240,000 	 198,000 	 320,000 	 290,364 	 285,600 	 210,600 
66	11.7% 	16.1% 	18.8% 	13.3% 	 300,503 	 197,623 	 306,502 	 269,700 	 252,676 	 280,000 	 225,884 	 240,000 	 198,000 	 320,000 	 261,327 	 285,600 	 210,600 
67	11.5% 	15.6% 	18.3% 	12.9% 	 301,119 	 196,551 	 307,228 	 269,700 	 252,865 	 310,000 	 225,884 	 260,000 	 180,000 	 320,000 	 230,839 	 285,600 	 210,600 
68	11.0% 	15.4% 	17.9% 	12.9% 	 303,397 	 196,431 	 307,132 	 290,000 	 256,003 	 310,000 	 250,982 	 260,000 	 180,000 	 320,000 	 230,839 	 285,600 	 210,600 
69	11.0% 	14.9% 	17.4% 	12.9% 	 303,397 	 196,397 	 307,049 	 290,000 	 257,926 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 261,327 	 285,600 	 210,600 
70	11.0% 	14.9% 	17.0% 	12.6% 	 303,397 	 196,397 	 307,235 	 290,000 	 257,926 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 261,327 	 285,600 	 210,600 
71	10.8% 	14.9% 	16.6% 	12.6% 	 303,682 	 196,397 	 307,262 	 290,000 	 266,093 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 326,659 	 285,600 	 210,600 
72	10.8% 	14.9% 	16.3% 	12.6% 	 303,682 	 196,397 	 307,285 	 290,000 	 257,926 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 261,327 	 285,600 	 210,600 
73	10.8% 	14.5% 	15.9% 	12.6% 	 303,682 	 196,553 	 307,264 	 295,000 	 261,556 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 290,364 	 285,600 	 210,600 
74	10.8% 	14.0% 	15.4% 	12.0% 	 303,682 	 196,102 	 307,080 	 295,000 	 267,039 	 320,000 	 225,884 	 260,000 	 180,000 	 320,000 	 261,327 	 285,600 	 283,500 
75	10.1% 	14.0% 	14.9% 	11.7% 	 302,911 	 196,102 	 307,203 	 295,000 	 265,789 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 261,327 	 285,600 	 283,500 
76	9.9% 	14.0% 	14.4% 	11.5% 	 303,960 	 196,102 	 307,181 	 310,000 	 269,418 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 290,364 	 285,600 	 283,500 
77	9.7% 	14.0% 	14.1% 	11.5% 	 302,983 	 196,102 	 306,959 	 310,000 	 269,418 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 290,364 	 285,600 	 283,500 
78	9.7% 	14.0% 	13.7% 	11.3% 	 302,983 	 196,102 	 307,129 	 295,000 	 273,356 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 290,364 	 285,600 	 315,000 
79	9.4% 	13.6% 	13.3% 	11.0% 	 303,739 	 195,972 	 307,451 	 295,000 	 269,418 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 290,364 	 285,600 	 283,500 
80	9.2% 	13.6% 	12.9% 	10.8% 	 303,707 	 195,972 	 307,941 	 295,000 	 269,418 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 290,364 	 285,600 	 283,500 
81	9.0% 	13.6% 	12.7% 	10.6% 	 304,847 	 195,972 	 308,138 	 295,000 	 268,926 	 320,000 	 250,982 	 260,000 	 180,000 	 310,000 	 261,327 	 285,600 	 283,500 
82	9.0% 	13.6% 	12.5% 	10.6% 	 304,847 	 195,972 	 308,370 	 290,000 	 265,789 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 261,327 	 285,600 	 283,500 
83	9.0% 	13.6% 	12.2% 	10.6% 	 304,847 	 195,972 	 308,683 	 290,000 	 265,789 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 261,327 	 285,600 	 283,500 
84	8.7% 	13.6% 	11.9% 	9.9% 	 303,922 	 195,972 	 308,791 	 290,000 	 265,846 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 264,231 	 280,000 	 286,650 
85	8.3% 	13.6% 	11.6% 	9.9% 	 298,862 	 195,972 	 309,050 	 290,000 	 268,983 	 320,000 	 250,982 	 260,000 	 180,000 	 310,000 	 264,231 	 280,000 	 286,650 
86	8.3% 	13.6% 	11.3% 	9.4% 	 298,862 	 195,972 	 309,145 	 290,000 	 265,846 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 264,231 	 280,000 	 286,650 
87	7.8% 	13.3% 	11.0% 	8.3% 	 297,913 	 195,503 	 309,443 	 290,000 	 265,403 	 320,000 	 228,394 	 260,000 	 180,000 	 310,000 	 261,327 	 280,000 	 283,500 
88	6.7% 	13.3% 	10.7% 	7.8% 	 299,433 	 195,503 	 309,531 	 290,000 	 264,460 	 320,000 	 225,884 	 260,000 	 180,000 	 310,000 	 253,145 	 280,000 	 286,650 
89	6.7% 	13.1% 	10.4% 	7.6% 	 299,433 	 195,459 	 310,376 	 290,000 	 267,274 	 320,000 	 228,394 	 260,000 	 180,000 	 310,000 	 253,145 	 300,000 	 286,650 
90	6.4% 	13.1% 	10.2% 	7.1% 	 299,948 	 195,459 	 311,134 	 290,000 	 272,009 	 320,000 	 228,394 	 260,000 	 216,000 	 310,000 	 278,182 	 280,000 	 283,500 
90	6.4% 	13.1% 	10.2% 	7.1% 	 299,948 	 195,459 	 311,134 	 290,000 	 272,009 	 320,000 	 228,394 	 260,000 	 216,000 	 310,000 	 278,182 	 280,000 	 283,500 
91	6.2% 	13.1% 	9.9% 	7.1% 	 302,747 	 195,459 	 312,016 	 290,000 	 268,880 	 320,000 	 228,394 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
92	6.2% 	12.9% 	9.7% 	7.1% 	 302,747 	 194,964 	 312,686 	 290,000 	 268,566 	 320,000 	 225,884 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
93	6.2% 	12.9% 	9.5% 	6.9% 	 302,747 	 194,964 	 312,992 	 290,000 	 310,000 	 320,000 	 228,394 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
94	6.0% 	12.6% 	9.4% 	6.9% 	 302,853 	 193,599 	 313,065 	 290,000 	 268,880 	 320,000 	 228,394 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
95	6.0% 	12.6% 	9.2% 	6.7% 	 302,853 	 193,599 	 313,803 	 290,000 	 274,970 	 340,000 	 228,394 	 260,000 	 216,000 	 310,000 	 250,364 	 280,000 	 315,000 
96	5.7% 	12.6% 	9.0% 	6.4% 	 304,527 	 193,599 	 314,051 	 290,000 	 274,274 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 286,650 
97	5.5% 	12.6% 	8.7% 	6.4% 	 306,216 	 193,599 	 314,120 	 290,000 	 273,566 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
98	5.5% 	12.6% 	8.5% 	6.2% 	 306,216 	 193,599 	 314,493 	 285,000 	 281,698 	 360,000 	 230,904 	 260,000 	 216,000 	 310,000 	 278,182 	 280,000 	 318,500 
99	5.3% 	12.4% 	8.2% 	6.0% 	 305,834 	 192,184 	 314,142 	 280,000 	 283,265 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 286,650 
100	5.1% 	12.2% 	8.0% 	5.3% 	 306,554 	 191,094 	 314,481 	 280,000 	 310,000 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 263,345 	 280,000 	 286,650 
101	4.4% 	12.2% 	7.7% 	4.8% 	 309,693 	 191,094 	 315,021 	 280,000 	 310,000 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 263,345 	 280,000 	 286,650 
102	4.4% 	12.2% 	7.5% 	4.8% 	 309,693 	 191,094 	 314,871 	 280,000 	 275,549 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 263,345 	 280,000 	 286,650 
103	4.4% 	12.2% 	7.3% 	4.8% 	 309,693 	 191,094 	 314,271 	 280,000 	 276,703 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 283,500 
104	4.4% 	12.0% 	7.1% 	4.8% 	 309,693 	 189,961 	 314,076 	 280,000 	 277,504 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 253,145 	 280,000 	 315,000 
105	4.4% 	12.0% 	7.0% 	4.8% 	 309,693 	 189,961 	 314,161 	 280,000 	 276,049 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 250,364 	 274,400 	 286,650 
106	4.4% 	12.0% 	6.9% 	4.8% 	 309,693 	 189,961 	 314,355 	 280,000 	 276,791 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 253,145 	 274,400 	 289,800 
107	4.4% 	11.7% 	6.7% 	4.6% 	 309,693 	 191,038 	 314,579 	 280,000 	 285,242 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 255,927 	 274,400 	 289,800 
108	4.1% 	11.5% 	6.6% 	4.4% 	 311,343 	 191,059 	 314,900 	 280,000 	 275,996 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 278,182 	 274,400 	 283,500 
109	3.9% 	11.5% 	6.4% 	4.4% 	 309,363 	 191,059 	 314,847 	 280,000 	 294,661 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 370,909 	 274,400 	 315,000 
110	3.9% 	11.5% 	6.3% 	4.4% 	 309,363 	 191,059 	 315,154 	 280,000 	 279,933 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 278,182 	 274,400 	 315,000 
111	3.9% 	11.5% 	6.1% 	4.4% 	 309,363 	 191,059 	 316,356 	 280,000 	 273,528 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 255,927 	 274,400 	 283,500 
112	3.9% 	11.5% 	6.0% 	4.4% 	 309,363 	 191,059 	 316,656 	 280,000 	 276,389 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 278,182 	 274,400 	 286,650 
113	3.9% 	11.3% 	5.9% 	4.4% 	 309,363 	 190,918 	 316,647 	 280,000 	 275,996 	 360,000 	 225,884 	 260,000 	 216,000 	 310,000 	 278,182 	 274,400 	 283,500 
114	3.9% 	11.0% 	5.7% 	4.4% 	 309,363 	 190,439 	 316,693 	 280,000 	 310,000 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 253,145 	 274,400 	 283,500 
115	3.9% 	11.0% 	5.7% 	4.4% 	 309,363 	 190,439 	 316,721 	 280,000 	 276,003 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 253,145 	 274,400 	 283,500 
116	3.9% 	10.8% 	5.6% 	4.4% 	 309,363 	 189,544 	 316,832 	 280,000 	 279,025 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 271,015 	 274,400 	 289,800 
117	3.9% 	10.8% 	5.5% 	4.4% 	 309,363 	 189,544 	 316,679 	 280,000 	 282,175 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 271,015 	 274,400 	 315,000 
118	3.9% 	10.8% 	5.4% 	4.4% 	 309,363 	 189,544 	 316,811 	 280,000 	 279,723 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 273,993 	 274,400 	 315,000 
119	3.9% 	10.8% 	5.3% 	4.4% 	 309,363 	 189,544 	 316,972 	 280,000 	 275,435 	 360,000 	 228,394 	 260,000 	 216,000 	 310,000 	 268,036 	 274,400 	 286,650 
120	3.9% 	10.8% 	5.2% 	4.4% 	 309,363 	 189,544 	 317,338 	 280,000 	 281,981 	 360,000 	 250,982 	 260,000 	 216,000 	 310,000 	 297,818 	 274,400 	 286,650 
121	3.9% 	10.6% 	5.1% 	4.4% 	 309,363 	 187,834 	 317,186 										
122	3.9% 	10.6% 	4.9% 	4.4% 	 309,363 	 187,834 	 316,680 										
123	3.9% 	10.3% 	4.9% 	4.4% 	 309,363 	 186,008 	 316,541 										
124	3.9% 	10.1% 	4.7% 	4.4% 	 309,363 	 185,236 	 316,139 										
125	3.9% 	10.1% 	4.7% 	4.1% 	 309,363 	 185,236 	 315,746 										
126	3.9% 	10.1% 	4.6% 	4.1% 	 309,363 	 185,236 	 315,884 										
127	3.9% 	9.9% 	4.6% 	4.1% 	 309,363 	 183,032 	 315,779 										
128	3.9% 	9.9% 	4.5% 	4.1% 	 309,363 	 183,032 	 315,982 										
129	3.9% 	9.9% 	4.5% 	4.1% 	 309,363 	 183,032 	 315,573 										
130	3.9% 	9.9% 	4.4% 	4.1% 	 309,363 	 183,032 	 315,531 										
131	3.9% 	9.9% 	4.4% 	4.1% 	 309,363 	 183,032 	 315,552 										
132	3.7% 	9.9% 	4.3% 	4.1% 	 307,448 	 183,032 	 315,614 										
133	3.7% 	9.9% 	4.3% 	4.1% 	 307,448 	 183,032 	 315,744 										
134	3.7% 	9.9% 	4.2% 	4.1% 	 307,448 	 183,032 	 315,569 										
135	3.7% 	9.9% 	4.2% 	4.1% 	 307,448 	 183,032 	 315,645 										
136	3.7% 	9.7% 	4.1% 	4.1% 	 307,448 	 182,297 	 315,667 										
137	3.7% 	9.7% 	4.1% 	3.9% 	 307,448 	 182,297 	 315,641 										
138	3.4% 	9.4% 	4.0% 	3.9% 	 307,945 	 181,914 	 315,580 										
139	3.4% 	9.2% 	4.0% 	3.9% 	 307,945 	 182,062 	 315,809 										
140	3.4% 	9.2% 	3.9% 	3.9% 	 307,945 	 182,062 	 314,982 										
141	3.4% 	9.2% 	3.8% 	3.9% 	 307,945 	 182,062 	 314,702 										
142	3.4% 	9.0% 	3.8% 	3.9% 	 307,945 	 181,246 	 314,543 										
143	3.4% 	9.0% 	3.7% 	3.7% 	 307,945 	 181,246 	 314,764 										
144	3.4% 	9.0% 	3.6% 	3.7% 	 307,945 	 181,246 	 314,982 										
145	3.4% 	9.0% 	3.6% 	3.7% 	 307,945 	 181,246 	 314,739 										
146	3.4% 	9.0% 	3.5% 	3.7% 	 307,945 	 181,246 	 314,456 										
147	3.4% 	9.0% 	3.5% 	3.7% 	 307,945 	 181,246 	 314,516 										
148	3.4% 	8.7% 	3.5% 	3.7% 	 307,945 	 180,189 	 314,416 										
149	3.4% 	8.7% 	3.5% 	3.2% 	 307,945 	 180,189 	 314,437 										
150	3.0% 	8.7% 	3.4% 	3.2% 	 309,167 	 180,189 	 313,957 										
151	3.0% 	8.5% 	3.4% 	3.2% 	 309,167 	 179,518 	 313,738 										
152	3.0% 	8.5% 	3.3% 	3.2% 	 309,167 	 179,518 	 313,219 										
153	3.0% 	8.5% 	3.3% 	3.2% 	 309,167 	 179,518 	 313,111 										
154	3.0% 	8.5% 	3.2% 	3.2% 	 309,167 	 179,518 	 313,252 										
155	3.0% 	8.5% 	3.1% 	3.2% 	 309,167 	 179,518 	 311,584 										
156	3.0% 	8.5% 	3.1% 	3.2% 	 309,167 	 179,518 	 311,127 										
157	3.0% 	8.0% 	3.0% 	3.2% 	 309,167 	 180,177 	 311,077 										
158	3.0% 	8.0% 	3.0% 	3.2% 	 309,167 	 180,177 	 311,043 										
159	3.0% 	8.0% 	3.0% 	3.2% 	 309,167 	 180,177 	 311,578 										
160	3.0% 	8.0% 	2.9% 	3.0% 	 309,167 	 180,177 	 312,517 										
161	2.8% 	8.0% 	2.9% 	3.0% 	 304,098 	 180,177 	 312,434 										
162	2.8% 	8.0% 	2.8% 	2.8% 	 304,098 	 180,177 	 312,404 										
163	2.5% 	8.0% 	2.8% 	2.5% 	 303,561 	 180,177 	 313,243 										
164	2.3% 	8.0% 	2.8% 	2.5% 	 296,917 	 180,177 	 314,547 										
165	2.3% 	8.0% 	2.7% 	2.5% 	 296,917 	 180,177 	 315,489 										
166	2.3% 	8.0% 	2.7% 	2.5% 	 296,917 	 180,177 	 316,301 										
167	2.3% 	8.0% 	2.7% 	2.5% 	 296,917 	 180,177 	 316,423 										
168	2.3% 	8.0% 	2.6% 	2.5% 	 296,917 	 180,177 	 316,301 										
169	2.3% 	8.0% 	2.6% 	2.5% 	 296,917 	 180,177 	 316,116 										
170	2.3% 	8.0% 	2.6% 	2.5% 	 296,917 	 180,177 	 315,730 										
171	2.3% 	8.0% 	2.5% 	2.5% 	 296,917 	 180,177 	 315,829 										
172	2.3% 	8.0% 	2.5% 	2.5% 	 296,917 	 180,177 	 315,661 										
173	2.3% 	8.0% 	2.5% 	2.5% 	 296,917 	 180,177 	 315,772 										
174	2.3% 	8.0% 	2.4% 	2.5% 	 296,917 	 180,177 	 315,500 										
175	2.3% 	7.6% 	2.4% 	2.5% 	 296,917 	 177,763 	 315,522 										
176	2.3% 	7.1% 	2.4% 	2.5% 	 296,917 	 174,035 	 315,074 										
177	2.3% 	7.1% 	2.3% 	2.3% 	 296,917 	 174,035 	 315,122 										
178	2.1% 	6.9% 	2.3% 	2.1% 	 296,575 	 171,466 	 314,923 										
179	1.8% 	6.9% 	2.3% 	2.1% 	 294,897 	 171,466 	 315,252 										
180	1.8% 	6.9% 	2.2% 	1.8% 	 294,897 	 171,466 	 315,541 										
181	1.6% 	6.9% 	2.2% 	1.8% 	 298,453 	 171,466 	 315,176 										
182	1.6% 	6.9% 	2.2% 	1.8% 	 298,453 	 171,466 	 315,078 										
183	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 315,611 										
184	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,530 										
185	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,558 										
186	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,783 										
187	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,658 										
188	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,501 										
189	1.6% 	6.9% 	2.1% 	1.8% 	 298,453 	 171,466 	 316,580 										
190	1.6% 	6.9% 	2.0% 	1.8% 	 298,453 	 171,466 	 316,407 										
191	1.6% 	6.9% 	2.0% 	1.8% 	 298,453 	 171,466 	 316,002 										
192	1.6% 	6.7% 	2.0% 	1.8% 	 298,453 	 172,199 	 315,599 										
193	1.6% 	6.7% 	2.0% 	1.8% 	 298,453 	 172,199 	 315,065 										
194	1.6% 	6.0% 	2.0% 	1.6% 	 298,453 	 170,415 	 314,340 										
195	1.4% 	6.0% 	1.9% 	1.6% 	 294,862 	 170,415 	 313,638 										
196	1.4% 	6.0% 	1.9% 	1.6% 	 294,862 	 170,415 	 312,641 										
197	1.4% 	6.0% 	1.9% 	1.6% 	 294,862 	 170,415 	 312,183 										
198	1.4% 	6.0% 	1.8% 	1.6% 	 294,862 	 170,415 	 312,399 										
199	1.4% 	6.0% 	1.8% 	1.6% 	 294,862 	 170,415 	 311,811 										
200	1.4% 	6.0% 	1.8% 	1.6% 	 294,862 	 170,415 	 311,023 										
201	1.4% 	6.0% 	1.7% 	1.6% 	 294,862 	 170,415 	 309,799 										
202	1.4% 	5.5% 	1.7% 	1.6% 	 294,862 	 170,260 	 308,989 										
203	1.4% 	5.5% 	1.7% 	1.6% 	 294,862 	 170,260 	 308,376 										
204	1.4% 	5.5% 	1.7% 	1.4% 	 294,862 	 170,260 	 307,567 										
205	1.1% 	5.5% 	1.6% 	1.4% 	 295,999 	 170,260 	 307,756 										
206	1.1% 	5.3% 	1.6% 	1.4% 	 295,999 	 171,476 	 307,623 										
207	1.1% 	5.3% 	1.6% 	1.4% 	 295,999 	 171,476 	 307,259 										
208	1.1% 	5.3% 	1.6% 	1.4% 	 295,999 	 171,476 	 306,394 										
209	1.1% 	5.3% 	1.6% 	1.1% 	 295,999 	 171,476 	 306,163 										
210	0.9% 	4.8% 	1.5% 	1.1% 	 295,000 	 171,988 	 306,201 										
211	0.9% 	4.6% 	1.5% 	1.1% 	 295,000 	 172,513 	 306,335 										
212	0.9% 	4.6% 	1.5% 	0.9% 	 295,000 	 172,513 	 305,683 										
213	0.7% 	4.6% 	1.5% 	0.9% 	 309,333 	 172,513 	 304,929 										
214	0.7% 	4.6% 	1.5% 	0.9% 	 309,333 	 172,513 	 304,929 										
215	0.7% 	4.6% 	1.5% 	0.9% 	 309,333 	 172,513 	 304,555 										
216	0.7% 	4.6% 	1.4% 	0.9% 	 309,333 	 172,513 	 304,543 										
217	0.7% 	4.6% 	1.4% 	0.9% 	 309,333 	 172,513 	 303,825 										
218	0.7% 	4.4% 	1.4% 	0.5% 	 309,333 	 171,666 	 303,501 										
219	0.2% 	4.4% 	1.4% 	0.5% 	 309,998 	 171,666 	 303,345 										
220	0.2% 	3.9% 	1.4% 	0.5% 	 309,998 	 172,168 	 303,240 										
221	0.2% 	3.9% 	1.4% 	0.5% 	 309,998 	 172,168 	 303,547 										
222	0.2% 	3.4% 	1.4% 	0.5% 	 309,998 	 173,950 	 303,327 										
223	0.2% 	3.4% 	1.3% 	0.5% 	 309,998 	 173,950 	 303,413 										
224	0.2% 	3.4% 	1.3% 	0.5% 	 309,998 	 173,950 	 303,026 										
225	0.2% 	3.4% 	1.3% 	0.5% 	 309,998 	 173,950 	 304,160 										
226	0.2% 	3.4% 	1.2% 	0.5% 	 309,998 	 173,950 	 305,477 										
227	0.2% 	3.4% 	1.2% 	0.5% 	 309,998 	 173,950 	 305,684 										
228	0.2% 	3.4% 	1.2% 	0.0% 	 309,998 	 173,950 	 306,014 										
229	0.0% 	3.4% 	1.2% 	0.0% 	 0 	 173,950 	 306,186 										
230	0.0% 	3.4% 	1.2% 	0.0% 	 0 	 173,950 	 306,020 										
231	0.0% 	3.2% 	1.1% 	0.0% 	 0 	 173,754 	 305,008 										
232	0.0% 	3.2% 	1.1% 	0.0% 	 0 	 173,754 	 305,881 										
233	0.0% 	3.2% 	1.1% 	0.0% 	 0 	 173,754 	 306,137 										
234	0.0% 	3.2% 	1.1% 	0.0% 	 0 	 173,754 	 307,182 										
235	0.0% 	3.0% 	1.1% 	0.0% 	 0 	 175,788 	 310,471 										
236	0.0% 	3.0% 	1.0% 	0.0% 	 0 	 175,788 	 311,718 										
237	0.0% 	3.0% 	1.0% 	0.0% 	 0 	 175,788 	 311,718 										
238	0.0% 	2.8% 	1.0% 	0.0% 	 0 	 176,087 	 312,010 										
239	0.0% 	2.8% 	1.0% 	0.0% 	 0 	 176,087 	 311,064 										
240	0.0% 	2.8% 	1.0% 	0.0% 	 0 	 176,087 	 310,615 										
241	0.0% 	2.8% 	1.0% 	0.0% 	 0 	 176,087 	 310,850 										
242	0.0% 	2.8% 	0.9% 	0.0% 	 0 	 176,087 	 311,084 										
243	0.0% 	2.8% 	0.9% 	0.0% 	 0 	 176,087 	 311,547 										
244	0.0% 	2.5% 	0.9% 	0.0% 	 0 	 171,186 	 312,388 										
245	0.0% 	2.5% 	0.9% 	0.0% 	 0 	 171,186 	 313,308 										
246	0.0% 	2.5% 	0.9% 	0.0% 	 0 	 171,186 	 313,967 										
247	0.0% 	2.5% 	0.9% 	0.0% 	 0 	 171,186 	 314,555 										
248	0.0% 	2.3% 	0.8% 	0.0% 	 0 	 170,304 	 314,935 										
249	0.0% 	2.3% 	0.8% 	0.0% 	 0 	 170,304 	 312,800 										
250	0.0% 	2.3% 	0.8% 	0.0% 	 0 	 170,304 	 312,073 										
251	0.0% 	1.8% 	0.7% 	0.0% 	 0 	 174,401 	 312,515 										
252	0.0% 	1.8% 	0.7% 	0.0% 	 0 	 174,401 	 312,490 										
253	0.0% 	1.6% 	0.7% 	0.0% 	 0 	 181,458 	 311,244 										
254	0.0% 	1.6% 	0.7% 	0.0% 	 0 	 181,458 	 310,436 										
255	0.0% 	1.6% 	0.6% 	0.0% 	 0 	 181,458 	 310,116 										
256	0.0% 	1.6% 	0.6% 	0.0% 	 0 	 181,458 	 309,176 										
257	0.0% 	1.6% 	0.6% 	0.0% 	 0 	 181,458 	 309,176 										
258	0.0% 	1.6% 	0.6% 	0.0% 	 0 	 181,458 	 308,391 										
259	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 307,591 										
260	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 306,774 										
261	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 305,178 										
262	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 305,540 										
263	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 305,911 										
264	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 305,910 										
265	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 304,302 										
266	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 304,302 										
267	0.0% 	1.4% 	0.6% 	0.0% 	 0 	 185,301 	 304,679 										
268	0.0% 	1.4% 	0.5% 	0.0% 	 0 	 185,301 	 305,065 										
269	0.0% 	1.4% 	0.5% 	0.0% 	 0 	 185,301 	 305,856 										
270	0.0% 	0.7% 	0.5% 	0.0% 	 0 	 202,002 	 306,064 										
271	0.0% 	0.7% 	0.5% 	0.0% 	 0 	 202,002 	 306,064 										
272	0.0% 	0.7% 	0.5% 	0.0% 	 0 	 202,002 	 305,849 										
273	0.0% 	0.7% 	0.5% 	0.0% 	 0 	 202,002 	 305,290 										
274	0.0% 	0.7% 	0.5% 	0.0% 	 0 	 202,002 	 303,532 										
275	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,591 										
276	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,547 										
277	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,547 										
278	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,547 										
279	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,612 										
280	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,150 										
281	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,543 										
282	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,543 										
283	0.0% 	0.7% 	0.4% 	0.0% 	 0 	 202,002 	 304,800 										
284	0.0% 	0.5% 	0.4% 	0.0% 	 0 	 220,000 	 303,082 										
285	0.0% 	0.5% 	0.4% 	0.0% 	 0 	 220,000 	 304,261 										
286	0.0% 	0.5% 	0.4% 	0.0% 	 0 	 220,000 	 304,022 										
287	0.0% 	0.5% 	0.3% 	0.0% 	 0 	 220,000 	 303,540 										
288	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 303,540 										
289	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 303,540 										
290	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 300,713 										
291	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 300,713 										
292	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 300,713 										
293	0.0% 	0.2% 	0.3% 	0.0% 	 0 	 230,000 	 299,615 										
294	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 298,476 										
295	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,946 										
296	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,290 										
297	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,400 										
298	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,515 										
299	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,635 										
300	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,760 										
301	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,760 										
302	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,760 										
303	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 295,209 										
304	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 293,935 										
305	0.0% 	0.0% 	0.3% 	0.0% 	 0 	 0 	 293,314 										
306	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 291,688 										
307	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 290,430 										
308	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 290,430 										
309	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 290,430 										
310	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 290,430 										
311	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 290,430 										
312	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 289,163 										
313	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 288,019 										
314	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 288,934 										
315	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 289,932 										
316	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 287,809 										
317	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 287,809 										
318	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 287,809 										
319	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 280,110 										
320	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 280,045 										
321	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 281,892 										
322	0.0% 	0.0% 	0.2% 	0.0% 	 0 	 0 	 283,888 										
323	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 277,800 										
324	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 278,139 										
325	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 277,146 										
326	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 277,146 										
327	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 281,910 										
328	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 284,900 										
329	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 284,900 										
330	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 284,900 										
331	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 275,513 										
332	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 259,157 										
333	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 259,157 										
334	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 252,746 										
335	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
336	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
337	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
338	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
339	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
340	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
341	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
342	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
343	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
344	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
345	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
346	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
347	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
348	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
349	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
350	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
351	0.0% 	0.0% 	0.1% 	0.0% 	 0 	 0 	 242,778 										
352	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 250,273 										
353	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 250,273 										
354	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 250,273 										
355	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 250,273 										
356	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
357	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
358	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
359	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
360	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
361	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
362	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
363	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
364	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
365	0.0% 	0.0% 	0.0% 	0.0% 	 0 	 0 	 0 										
`;

        // --- Config ---
        const topChartKeys = [
            "OCC ÏûêÏÇ¨", "OCC Í≤ΩÏüÅÏÇ¨", "OCC Ï†ÑÎÖÑ", "OCC ÏµúÍ≥†Í∞ÄÏãúÍ∏∞",
            "ADR", "ADR Ï†ÑÎÖÑ", "ADR ÏµúÍ≥†Í∞ÄÏãúÍ∏∞"
        ];

        const bottomChartKeys = [
            "ÏûêÏÇ¨ÏµúÏ†ÄÍ∞Ä", "Í≤ΩÏüÅÏÇ¨ ÏµúÏ†ÄÍ∞Ä",
            "Stanford_Hotel_Myeongdong", "Crown_Park_Hotel_Seoul_Myeongdong",
            "L7_MYEONGDONG_by_LOTTE_HOTELS", "Shilla_Stay_Gwanghwamun_Myeongdong",
            "Nine_Tree_by_Parnas_Seoul_Myeongdong_2", "Four_Points_by_Sheraton_Josun_Seoul_Myeongdong",
            "Ibis_Ambassador_Myeongdong", "Aloft_Seoul_Myeongdong"
        ];

        // Keys to show as dashed line when N <= 30 (OCC and ADR data)
        const keysToDashNearZero = ["OCC ÏûêÏÇ¨", "OCC Í≤ΩÏüÅÏÇ¨", "ADR"];
        
        // Default visible keys on page load
        const defaultTopChartKeys = ["OCC ÏûêÏÇ¨", "OCC Í≤ΩÏüÅÏÇ¨"];
        const defaultBottomChartKeys = ["ÏûêÏÇ¨ÏµúÏ†ÄÍ∞Ä", "Í≤ΩÏüÅÏÇ¨ ÏµúÏ†ÄÍ∞Ä"];

        // --- Parser ---
        function parseData(data) {
            const lines = data.trim().split('\n');
            const headers = lines[0].split('\t').map(h => h.trim());
            const result = { labels: [], datasets: {} };

            headers.forEach(h => {
                if (h !== 'N') result.datasets[h] = [];
            });

            for (let i = 1; i < lines.length; i++) {
                const row = lines[i].split('\t');
                const nVal = parseInt(row[0].trim(), 10);
                result.labels.push(nVal);

                row.forEach((val, idx) => {
                    const header = headers[idx];
                    if (header === 'N') return;

                    let numVal = null;
                    let cleanVal = val ? val.trim() : "";

                    if (cleanVal !== "") {
                        cleanVal = cleanVal.replace(/,/g, '').replace(/%/g, '');
                        numVal = parseFloat(cleanVal);
                    }

                    // Masking Logic (N=0~30) - only for bottom chart keys
                    if (nVal <= 30) {
                        if (bottomChartKeys.includes(header)) {
                            numVal = null;
                        }
                    }

                    result.datasets[header].push(numVal);
                });
            }
            return result;
        }

        const fullData = parseData(rawData);

        // --- Data Filter ---
        function getFilteredData(maxN) {
            // We filter based on N value
            const indices = [];
            fullData.labels.forEach((n, idx) => {
                if (maxN === 'all' || n <= maxN) {
                    indices.push(idx);
                }
            });

            const newLabels = indices.map(i => fullData.labels[i]);
            const newDatasets = {};

            Object.keys(fullData.datasets).forEach(key => {
                newDatasets[key] = indices.map(i => fullData.datasets[key][i]);
            });

            return { labels: newLabels, datasets: newDatasets };
        }

        // --- Custom Plugin for Background Area (N=0~30) ---
        const backgroundAreaPlugin = {
            id: 'backgroundArea',
            beforeDraw: (chart) => {
                const ctx = chart.ctx;
                const xAxis = chart.scales.x;
                const yAxis = chart.scales.y || chart.scales.y1;
                
                // Find indices for values 0 and 30 in labels
                const labels = chart.data.labels;
                const idx0 = labels.indexOf(0);
                const idx30 = labels.indexOf(30);
                
                if (idx0 === -1 || idx30 === -1) return;
                
                // Get pixel positions
                const x0 = xAxis.getPixelForValue(idx0);
                const x30 = xAxis.getPixelForValue(idx30);
                
                ctx.save();
                ctx.fillStyle = 'rgba(59, 130, 246, 0.06)'; // ÌååÎûÄÏÉâ Î∞òÌà¨Î™Ö Î∞∞Í≤Ω
                ctx.fillRect(
                    Math.min(x0, x30),
                    yAxis.top,
                    Math.abs(x30 - x0),
                    yAxis.bottom - yAxis.top
                );
                ctx.restore();
            }
        };
        
        // Register the plugin globally
        Chart.register(backgroundAreaPlugin);

        // --- Colors (Modern palette for white theme) ---
        const colors = [
            '#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899',
            '#06b6d4', '#84cc16', '#f97316', '#6366f1', '#14b8a6', '#eab308'
        ];
        function getColor(idx) { return colors[idx % colors.length]; }

        // --- Chart Globals ---
        let topChart, bottomChart;

        function initCharts(data) {
            const topDatasets = topChartKeys.map((key, index) => {
                const isPercentage = key.includes("OCC");
                const isDashedKey = keysToDashNearZero.includes(key);
                const isDefaultVisible = defaultTopChartKeys.includes(key);
                
                const dataset = {
                    label: key,
                    data: data.datasets[key],
                    borderColor: getColor(index),
                    backgroundColor: getColor(index),
                    borderWidth: 2,
                    pointRadius: 0,
                    pointHoverRadius: 4,
                    tension: 0.3,
                    yAxisID: isPercentage ? 'y' : 'y1',
                    hidden: !isDefaultVisible
                };
                
                // Add dashed line segment for N <= 30 for specific keys
                if (isDashedKey) {
                    dataset.segment = {
                        borderDash: ctx => {
                            const labelValue = data.labels[ctx.p1DataIndex];
                            return labelValue <= 30 ? [6, 4] : undefined;
                        }
                    };
                }
                
                return dataset;
            });

            const bottomDatasets = bottomChartKeys.map((key, index) => {
                const isDefaultVisible = defaultBottomChartKeys.includes(key);
                return {
                    label: key,
                    data: data.datasets[key],
                    borderColor: getColor(index + topChartKeys.length),
                    backgroundColor: getColor(index + topChartKeys.length),
                    borderWidth: 2,
                    pointRadius: 0,
                    pointHoverRadius: 4,
                    tension: 0.3,
                    hidden: !isDefaultVisible
                };
            });

            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#ffffff',
                        titleColor: '#1e293b',
                        bodyColor: '#64748b',
                        borderColor: '#e2e8f0',
                        borderWidth: 1,
                        padding: 12,
                        boxPadding: 6,
                        cornerRadius: 8,
                        titleFont: { weight: '600' }
                    }
                },
                scales: {
                    x: {
                        reverse: true, // X-axis reversed
                        grid: { color: '#f1f5f9' },
                        ticks: { color: '#64748b', font: { weight: '500' } }
                    }
                }
            };

            const topCtx = document.getElementById('topChart').getContext('2d');
            topChart = new Chart(topCtx, {
                type: 'line',
                data: { labels: data.labels, datasets: topDatasets },
                options: {
                    ...commonOptions,
                    scales: {
                        ...commonOptions.scales,
                        y: {
                            type: 'linear', display: true, position: 'left',
                            grid: { color: '#f1f5f9' },
                            ticks: { color: '#64748b', font: { weight: '500' }, callback: v => v + '%' },
                            title: { display: true, text: 'OCC (%)', color: '#64748b', font: { weight: '600' } }
                        },
                        y1: {
                            type: 'linear', display: true, position: 'right',
                            grid: { drawOnChartArea: false },
                            ticks: { color: '#64748b', font: { weight: '500' }, callback: v => v.toLocaleString() },
                            title: { display: true, text: 'ADR', color: '#64748b', font: { weight: '600' } }
                        }
                    }
                }
            });

            const bottomCtx = document.getElementById('bottomChart').getContext('2d');
            bottomChart = new Chart(bottomCtx, {
                type: 'line',
                data: { labels: data.labels, datasets: bottomDatasets },
                options: {
                    ...commonOptions,
                    scales: {
                        ...commonOptions.scales,
                        y: {
                            grid: { color: '#f1f5f9' },
                            ticks: { color: '#64748b', font: { weight: '500' }, callback: v => v.toLocaleString() }
                        }
                    }
                }
            });

            createControls(topChart, 'topControls');
            createControls(bottomChart, 'bottomControls');
        }

        function createControls(chart, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            chart.data.datasets.forEach((dataset, index) => {
                const item = document.createElement('label');
                item.className = 'checkbox-item';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = !dataset.hidden;

                checkbox.addEventListener('change', (e) => {
                    chart.setDatasetVisibility(index, e.target.checked);
                    chart.update();
                });
                checkbox.style.setProperty('--accent-color', dataset.borderColor);
                checkbox.style.borderColor = dataset.borderColor;

                const label = document.createElement('span');
                label.innerText = dataset.label;

                item.appendChild(checkbox);
                item.appendChild(label);
                container.appendChild(item);
            });
        }

        // --- Range Function ---
        window.setRange = function (range, btn) {
            document.querySelectorAll('.range-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const sliced = getFilteredData(range);

            function updateChartData(chart, newSlice) {
                chart.data.labels = newSlice.labels;
                // Update data for each dataset, preserving other properties
                chart.data.datasets.forEach(ds => {
                    ds.data = newSlice.datasets[ds.label];
                });
                chart.update();
            }

            updateChartData(topChart, sliced);
            updateChartData(bottomChart, sliced);
        };

        // Initialize with 120 days range
        initCharts(getFilteredData(120));

    </script>
</body>

</html>